<!-- views/pages/index.ejs -->

<!DOCTYPE html>
<html lang="en">
<head>
  <%- include ('../partials/head.ejs') %>
  <style>
    <%- css.style %>

    #ava-mask {
      bottom: 0;
      left: 0;
    }

    #ava:hover #ava-mask {
      display: flex;
      opacity: 0.75;
    }

    .education-time::before {
      content: "";
      width: 0.75rem;
      height: 0.75rem;
      background: #cecece;
      position: absolute;
      border-radius: 99px;
      top: 50%;
      left: -1rem;
      transform: translate(-50%, -50%);
    }
  </style>
</head>

<body class="bg-gray-300">
  <header>
    <%- include ('../partials/header.ejs') %>
  </header>
  <main class="container m-auto mt-24">
    <form id="create-form" enctype="multipart/form-data">
      <div class="bg-white rounded my-6 p-6 flex items-end">
        <input type="text" name="title" class="border-b border-solid border-gray-300 px-4 py-2 outline-none" placeholder="CV title 🍉">
        <div class="mx-8">Update on <span class="font-bold"><%= now %></span></div>
        <input type="text" name="update" value="<%= now %>" class="hidden">
        <button type="submit" class="rounded outline-none border-none hover:bg-green-500 bg-green-600 text-white transition-all duration-300 px-3 py-2 text-sm">
          create 🚀
        </button>
      </div>
      <div class="bg-white my-6 rounded flex">
        <div class="w-4/12 flex flex-col border-r border-solid border-gray-300 p-6">
          <div id="ava" class="cursor-pointer w-full hover:border-blue-500 border border-dashed border-transparent transition-all duration-200 flex items-center justify-center" style="height: 300px">
            <div class="w-56 h-56 rounded-full overflow-hidden relative border border-solid border-gray-300">
              <!-- display image -->
              <img class="w-56 h-56 hidden" id="preview" alt="preview">
              <input type="file" name="avatar" class="hidden" id="cv-avatar">
              <div class="bg-gray-400 w-full absolute flex items-center justify-center h-24 transition-all duration-30 opacity-25" id="ava-mask">
                <span class="text-3xl">📷</span>
              </div>
            </div>
          </div>
          <div class="flex items-center mt-4">
            <label for="birth" class="uppercase">birthday</label>
            <input class="outline-none border-none px-4 py-2 flex-1" type="text" id="birthday" name="birthday" placeholder="your date of birth">
          </div>
          <div class="flex items-center">
            <label for="phone" class="uppercase">phone</label>
            <input class="outline-none border-none px-4 py-2 flex-1" type="text" id="phone" name="phone" placeholder="your phone number">
          </div>
          <div class="flex items-center">
            <label for="address" class="uppercase">address</label>
            <input class="outline-none border-none px-4 py-2 flex-1" type="text" id="address" name="address" placeholder="your address">
          </div>
          <div class="flex items-center">
            <label for="email" class="uppercase">email</label>
            <input class="outline-none border-none px-4 py-2 flex-1" type="text" id="email" name="email" placeholder="your email">
          </div>
          <div class="flex items-center">
            <label for="github" class="uppercase">github</label>
            <input class="outline-none border-none px-4 py-2 flex-1" type="text" id="github" name="github" placeholder="your github">
          </div>
          <div class="flex items-center">
            <label for="facebook" class="uppercase">facebook</label>
            <input class="outline-none border-none px-4 py-2 flex-1" type="text" id="facebook" name="facebook" placeholder="your facebook">
          </div>
          <div class="flex items-center">
            <label for="instagram" class="uppercase">instagram</label>
            <input class="outline-none border-none px-4 py-2 flex-1" type="text" id="instagram" name="instagram" placeholder="your instagram">
          </div>
          <div class="mt-3">
            <p class="uppercase"><span class="text-3xl mr-4">🎮</span>hobbies</p>
            <input class="outline-none border-none px-4 py-2 flex-1" type="text" id="hobbies" name="hobbies" placeholder="your hobbies">
          </div>
          <div class="mt-3">
            <p class="uppercase"><span class="text-3xl mr-4">🎓</span>education</p>
            <div class="border-l border-solid border-gray-400 ml-4 pl-4">
              <div class="education-time relative">
                <input class="outline-none border-none py-2 flex-1" type="text" id="education-time" name="school-duration" placeholder="mm/yyyy - mm/yyyy">
              </div>
              <input class="outline-none border-none py-2 flex-1" type="text" id="school-name" name="school-name" placeholder="School name">
              <input class="outline-none border-none py-2 flex-1" type="text" id="major" name="major-name" placeholder="Major name">
              <div class="flex items-center">
                <label for="gpa" class="uppercase">gpa:</label>
                <input class="outline-none border-none px-4 py-2 flex-1" type="text" id="gpa" name="gpa" placeholder="4.0">
              </div>
              <input class="outline-none border-none py-2 flex-1" type="text" id="school-description" name="school-description" placeholder="description">
            </div>
          </div>
          <div class="mt-3">
            <p class="uppercase"><span class="text-3xl mr-4">🌏</span>languages</p>
            <div class="ml-4">
              <input class="outline-none border-none py-2 flex-1 w-full" type="text" id="language-name" name="lang-name" placeholder="LANGUAGE NAME">
              <input class="outline-none border-none py-2 flex-1 w-full" type="text" id="language-efficiency" name="lang-fluent-rate" placeholder="0/10">
            </div>
          </div>
        </div>
        <div class="w-8/12">
          <div class="border border-dashed border-transparent hover:border-blue-500 transition-all duration-300 p-6">
            <p class="uppercase">hi, i am</p>
            <input class="outline-none border-none py-2 flex-1 w-full" autocomplete="off" type="text" name="name" id="username" value=<%=userName%>>
            <input class="outline-none border-none py-2 flex-1 w-full" type="text" id="position" name="position" placeholder="your position">
          </div>
          <div class="border border-dashed border-transparent hover:border-blue-500 transition-all duration-300 p-6">
            <p class="uppercase"><span class="text-3xl mr-4">🎯</span>career gold</p>
            <input class="outline-none border-none py-2 flex-1 w-full" type="text" id="career-goal" name="career-goal" placeholder="description">
          </div>
          <div class="border border-dashed border-transparent hover:border-blue-500 transition-all duration-300 p-6">
            <p class="uppercase"><span class="text-3xl mr-4">⚔️</span>skill</p>
            <input class="outline-none border-none py-2 flex-1 w-full" type="text" name="skills" id="skills" placeholder="skills">
          </div>
          <div class="border border-dashed border-transparent hover:border-blue-500 transition-all duration-300 p-6">
            <p class="uppercase"><span class="text-3xl mr-4">🌈</span>experiences</p>
            <div class="flex flex-col border-l border-solid border-gray-400 ml-4 pl-4">
              <div class="education-time relative">
                <input class="outline-none border-none py-2 flex-1" type="text" id="company-time" name="company-working-duration" placeholder="mm/yyyy - mm/yyyy">
              </div>
              <input class="outline-none border-none py-2 flex-1" type="text" id="company-name" name="company-name" placeholder="company name">
              <input class="outline-none border-none py-2 flex-1" type="text" id="company-position" name="company-role" placeholder="your position">
              <input class="outline-none border-none py-2 flex-1" type="text" id="company-description" name="company-description" placeholder="description">
            </div>
          </div>
          <div class="border border-dashed border-transparent hover:border-blue-500 transition-all duration-300 p-6">
            <p class="uppercase"><span class="text-3xl mr-4">🏆</span>achievements</p>
            <div class="flex flex-col border-l border-solid border-gray-400 ml-4 pl-4">
              <div class="education-time relative">
                <input class="outline-none border-none py-2 flex-1" type="text" id="achievements-time" name="achievement-duration" placeholder="mm/yyyy - mm/yyyy">
              </div>
              <input class="outline-none border-none py-2 flex-1" type="text" id="achievements-name" name="achievement-name" placeholder="achievements name">
              <input class="outline-none border-none py-2 flex-1" type="text" id="achievements-description" name="achievement-description" placeholder="description">
            </div>
          </div>
          <div class="border border-dashed border-transparent hover:border-blue-500 transition-all duration-300 p-6">
            <p class="uppercase"><span class="text-3xl mr-4">📁</span>project</p>
            <div class="flex flex-col border-l border-solid border-gray-400 ml-4 pl-4">
              <div class="education-time relative">
                <input class="outline-none border-none py-2 flex-1" type="text" id="project-time" name="project-duration" placeholder="mm/yyyy - mm/yyyy">
              </div>
              <input class="outline-none border-none py-2 flex-1" type="text" id="project-name" name="project-name" placeholder="project name">
              <input class="outline-none border-none py-2 flex-1" type="text" id="project-link" name="project-link" placeholder="link">
              <input class="outline-none border-none py-2 flex-1" type="text" id="project-description" name="project-description" placeholder="description">
            </div>
          </div>
        </div>
      </div>
    </form>
  </main>
  <%- include ('../partials/footer.ejs') %>
  <script>
    $(function () {
      const $ELE = {
        avaWrapper: $('#ava'),
        avaMask: $('#ava-mask'),
        inputAva: $('#cv-avatar'),
        avaPreview: $('#preview'),
        formCreate: $('#create-form')
      }

      function onPickingAva($ele) {
        $ele.on('click', function(event) {
          event.preventDefault()
          $ELE.inputAva.trigger('click')
        })
      }

      $ELE.inputAva.change(function(event) {
        const file = event.target.files[0]
        const reader = new FileReader()
        reader.readAsDataURL(file)
        reader.onloadend = function(e) {
          $ELE.avaPreview.removeClass('hidden').attr('src', e.target.result)
        }
      })

      function onCreateCV($ele) {
        $ele.submit(function (e) {
          e.preventDefault();
          const form = $ELE.formCreate[0]
          let formData = new FormData(form)
          // formData.append("title", "hi")
          // formData.append("image", file1)
          // formData.append("image", file2)

          $.ajax({
            type: "POST",
            url: "/cv/create",
            data: formData,
            contentType: false,
            processData: false,
            // dataType: "json",
            success: function (response) {

            }
          });
        });
      }

      function init() {
        onPickingAva($ELE.avaMask)
        onCreateCV($ELE.formCreate)
      }

      init()
    });
  </script>
</body>

</html>
